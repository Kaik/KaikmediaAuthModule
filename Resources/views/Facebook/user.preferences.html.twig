{# preferences #}
{% extends 'KaikmediaAuthModule:Base:user.html.twig' %}
{% block header %}
    {% set settings='settings' %}
    {{ parent() }}
{% endblock %} 
{% block title %}
    {% set title_icon="<i class='fa fa-facebook'></i>" %}
    {% set title=__('Facebook settings') %}
    {{ parent() }}
{% endblock %}
{% block content %}
    <div id="km_auth_user_facebook_preferences" class="col-md-12 clearfix">
        <div class="row {{ isConnected ? ''  : ''  }}">
            <div id="facebook_preferences_profile" class="col-lg-6 col-lg-push-3">
                <div class="panel panel-default">
                    <div class="panel-image panel-body">
                        <div class="row">
                            <div class="col-xs-12 text-center" style="margin-bottom:15px;">
                                {{ userAvatar(user.uid, {'class': 'current-user-avatar img-circle '}) }}                     
                            </div>
                            <div class="text-center">
                                <a href="#" 
                                   class="btn btn-sm btn-default"
                                   onclick="KaikMedia.Auth.facebook.updateAvatar();"
                                   >
                                    {{ __('Update avatar form facebook') }}
                                </a> 
                            </div>
                        </div>
                    </div>        
                    <div class="panel-body">
                        <div class="row">
                            {# <div class="col-xs-12 text-center">
                                <h2>
                                    {{ user.uname }}
                                </h2>
                                <a href="#" class="btn btn-sm btn-default">
                                    {{ __('Change username') }}
                                </a> 
                            </div> #}
                            <div class="col-xs-12 text-center">
                                <h2 class="realname">
                                    {% if attribute(user.attributes, 'zpmpp:realname') is defined %}
                                        {{ attribute(user.attributes, 'zpmpp:realname') }}
                                    {% else %}
                                        <small>
                                            {{ __('No name selected') }}
                                        </small>
                                    {% endif %}
                                </h2>
                                <a href="#" 
                                   class="btn btn-sm btn-default"
                                   onclick="KaikMedia.Auth.facebook.updateName();"
                                    >
                                    {{ __('Update name from facebook') }}
                                </a>                                
                            </div>
                        </div>
                    </div>
                    <div id="km_auth_user_facebook_preferences_display_more" class="panel-footer text-center">
                        <a class="btn btn-link" 
                            role="button" 
                            data-toggle="collapse" 
                            href="#collapseExample" 
                            aria-expanded="false" 
                            aria-controls="collapseExample">
                            {{__('More')}}
                        </a>
                        <div class="collapse" id="collapseExample">
                            <h5>{{ __('Disable facebook') }} </h5>
                            <p class="info-text">
                                {{__('Remove connection between this account and your facebook account, but leave permissions.')}}
                            </p>
                            <a href="#" 
                               class="btn btn-sm btn-default"
                               onclick="KaikMedia.Auth.facebook.disconnect();"
                               >
                                {{ __('Disconnect account') }}
                            </a>
                            <h5>{{ __('Disconnect and remove facebook') }} </h5>
                            <p class="info-text">
                                {{__('Remove connection between this account and your facebook account, and revoke all permissions.')}}
                            </p>
                            <a href="#" 
                               class="btn btn-sm btn-danger"
                               onclick="KaikMedia.Auth.facebook.revoke();"
                               >
                                {{ __('Revoke permissions') }}
                            </a>    
                        </div>
                    </div>
                    <div id="km_auth_user_facebook_preferences_display_connect_button" 
                        class="text-center {{ isConnected ? 'hide'  : '' }}"
                        style="
                        position: absolute;
                        top: 0;
                        width: 100%;
                        height: 100%;
                        background: #fff;
                        padding-top:150px;
                        padding-left:15px;
                        padding-right:15px;
                        "
                        >
                        <h4>
                            {{ __('You account is not connected to Facebook. Click on button below to connect accounts.') }}
                        </h4>
                        {#  this a will be replaced #}
                        <a>kaikmedia_auth_facebook_button_large-continue_with-rounded-no-yes</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
{% block footer %}
    {{ parent() }}
{% endblock %}

    {# 
    @todo - below information needs more permissions
    // to update them one woudl have to allow it via addiotional permissions call
    // 
    <h6 class="text-muted">
        {% if getModVar('ZikulaProfileModule', 'viewregdate', 1) == 1 and user.user_regdate != '1970-01-01 00:00:00' %}
            {{ __('Registered:') }} <span>{{ user.user_regdate|localizeddate('medium', 'none')|default('&nbsp;') }}</span>
        {% endif %}
    </h6>
    {% if attribute(user.attributes, 'zpmpp:birthday') is defined %}
        <div class="col-xs-12">
            <span class="text-muted">{{ attribute(user.attributes, 'zpmpp:birthday').extra }}:</span> {{ attribute(user.attributes, 'zpmpp:birthday')|raw }}
        </div>
    {% endif %}
    {% if attribute(user.attributes, 'zpmpp:city') is defined %}
        <div class="col-xs-12">
            <span class="text-muted">{{ attribute(user.attributes, 'zpmpp:city').extra }}:</span> {{ attribute(user.attributes, 'zpmpp:city')|raw }}
        </div>
    {% endif %}
    {% if attribute(user.attributes, 'zpmpp:interests') is defined %}
        <div class="col-xs-12">
            <span class="text-muted">{{ attribute(user.attributes, 'zpmpp:interests').extra }}:</span> {{ attribute(user.attributes, 'zpmpp:interests')|raw }}
        </div>
    {% endif %}
    {% if attribute(user.attributes, 'zpmpp:url') is defined %}
        <div class="col-xs-12">
            <span class="text-muted">{{ attribute(user.attributes, 'zpmpp:url').extra }}:</span> {{ attribute(user.attributes, 'zpmpp:url')|raw }}
        </div>
    {% endif %} #}